function [ erro ] = otimiza_Esq( X )
%UNTITLED4 Summary of this function goes here
%   Detailed explanation goes here
global x t u_l num den

dt = 0.001;

%referência
wn = 10;
ksi = 0.8;

num = 2.868e-05;

den = -0.995;

% num_ref =  [0.0002868   0.0002868];
% den_ref = [1 -0.995];
x = X;
w=warning('off','all');
sim('planta',t);
warning(w);

y_dir = [0.102948296925488;0.307971850840834;0.510196087484995;0.708592297196953;0.903220188862094;1.09414959215564;1.28144916600500;1.46518630362385;1.64542715460816;1.82223664783540;1.99567851395476;2.16581530746329;2.33270842837551;2.49641814349394;2.65700360728794;2.81452288238799;2.96903295970260;3.12058977816469;3.26924824411440;3.41506225032483;3.55808469467751;3.69836749849382;3.83596162452894;3.97091709463428;4.10328300709477;4.23310755364671;4.36043803618237;4.48532088314678;4.60780166563270;4.72792511317906;4.84573512927850;4.96127480659930;5.07458644192698;5.18571155083068;5.29469088205947;5.40156443167355;5.50637145691508;5.60915048982370;5.70993935060117;5.80877516072994;5.90569435585006;6.00073269839901;6.09392529001862;6.18530658373360;6.27491039590569;6.36276991796771;6.44891772794143;6.53338580174335;6.61620552428226;6.69740770035234;6.77702256532573;6.85507979564809;6.93160851914089;7.00663732511389;7.08019427429150;7.15230690855611;7.22300226051221;7.29230686287412;7.36024675768097;7.42684750534189;7.49213419351458;7.55613144582045;7.61886343039907;7.68035386830524;7.74062604175124;7.79970280219739;7.85760657829346;7.91435938367396;7.96998282460969;8.02449810751848;8.07792604633750;8.13028706975981;8.18160122833762;8.23188820145473;8.28116730417045;8.32945749393757;8.37677737719652;8.42314521584805;8.46857893360675;8.51309612223747;8.55671404767689;8.59944965604232;8.64131957952984;8.68234014220375;8.72252736567941;8.76189697470136;8.80046440261875;8.83824479675981;8.87525302370739;8.91150367447734;8.94701106960136;8.98178926411640;9.01585205246200;9.04921297328747;9.08188531417056;9.11388211624908;9.14521617876732;9.17590006353861;9.20594609932580;9.23536638614087;9.26417279946549;9.29237699439370;9.31999040969837;9.34702427182266;9.37348959879801;9.39939720408991;9.42475770037280;9.44958150323551;9.47387883481828;9.49765972738296;9.52093402681725;9.54371139607451;9.56600131855013;9.58781310139571;9.60915587877215;9.63003861504285;9.65047010790805;9.67045899148138;9.69001373930982;9.70914266733792;9.72785393681742;9.74615555716335;9.76405538875733;9.78156114569940;9.79868039850902;9.81542057677633;9.83178897176458;9.84779273896460;9.86343890060214;9.87873434809911;9.89368584448938;9.90830002679007;9.92258340832921;9.93654238103040;9.95018321765547;9.96351207400576;9.97653499108279;9.98925789720923;10.0016866101107;10.0138268389590;10.0256841863784;10.0372641504139;10.0485721264640;10.0596134091778;10.0703931943165;10.0809165805816;10.0911885714084;10.1012140767269;10.1109979146906;10.1205448133727;10.1298594124315;10.1389462647452;10.1478098380160;10.1564545163454;10.1648846017796;10.1731043158275;10.1811178009493;10.1889291220193;10.1965422677603;10.2039611521521;10.2111896158146;10.2182314273645;10.2250902847473;10.2317698165451;10.2382735832597;10.2446050785726;10.2507677305814;10.2567649030134;10.2625998964171;10.2682759493317;10.2737962394345;10.2791638846679;10.2843819443451;10.2894534202358;10.2943812576313;10.2991683463907;10.3038175219672;10.3083315664156;10.3127132093818;10.3169651290730;10.3210899532110;10.3250902599672;10.3289685788810;10.3327273917605;10.3363691335675;10.3398961932852;10.3433109147707;10.3466155975914;10.3498124978458;10.3529038289699;10.3558917625275;10.3587784289874;10.3615659184847;10.3642562815698;10.3668515299416;10.3693536371691;10.3717645393982;10.3740861360464;10.3763202904841;10.3784688307037;10.3805335499763;10.3825162074960;10.3844185290127;10.3862422074529;10.3879889035294;10.3896602463391;10.3912578339507;10.3927832339808;10.3942379841597;10.3956235928865;10.3969415397743;10.3981932761854;10.3993802257558;10.4005037849110;10.4015653233721;10.4025661846518;10.4035076865422;10.4043911215931;10.4052177575813;10.4059888379721;10.4067055823708;10.4073691869677;10.4079808249729;10.4085416470451;10.4090527817108;10.4095153357764;10.4099303947333;10.4102990231543;10.4106222650837;10.4109011444196;10.4111366652896;10.4113298124190;10.4114815514928;10.4115928295103;10.4116645751342;10.4116976990320;10.4116930942121;10.4116516363532;10.4115741841276;10.4114615795189;10.4113146481332;10.4111341995054;10.4109210273987;10.4106759101001;10.4103996107086;10.4100928774199;10.4097564438043;10.4093910290806;10.4089973383843;10.4085760630308;10.4081278807744;10.4076534560617;10.4071534402808;10.4066284720057;10.4060791772363;10.4055061696340;10.4049100507527;10.4042914102657;10.4036508261884;10.4029888650968;10.4023060823423;10.4016030222617;10.4008802183845;10.4001381936353;10.3993774605328;10.3985985213855;10.3978018684835;10.3969879842862;10.3961573416078;10.3953104037980;10.3944476249202;10.3935694499261;10.3926763148275;10.3917686468638;10.3908468646680;10.3899113784282;10.3889625900468;10.3880008932968;10.3870266739750;10.3860403100522;10.3850421718211;10.3840326220409;10.3830120160800;10.3819807020548;10.3809390209672;10.3798873068392;10.3788258868443;10.3777550814373;10.3766752044815;10.3755865633732;10.3744894591643;10.3733841866823;10.3722710346486;10.3711502857936;10.3700222169710;10.3688870992687;10.3677451981185;10.3665967734038;10.3654420795641;10.3642813656993;10.3631148756710;10.3619428482018;10.3607655169734;10.3595831107225;10.3583958533350;10.3572039639384;10.3560076569925;10.3548071423784;10.3536026254859;10.3523943072995;10.3511823844822;10.3499670494581;10.3487484904939;10.3475268917778;10.3463024334983;10.3450752919202;10.3438456394601;10.3426136447601;10.3413794727604;10.3401432847700;10.3389052385369;10.3376654883162;10.3364241849376;10.3351814758710;10.3339375052914;10.3326924141423;10.3314463401982;10.3301994181255;10.3289517795425;10.3277035530788;10.3264548644324;10.3252058364267;10.3239565890664;10.3227072395919;10.3214579025328;10.3202086897607;10.3189597105406;10.3177110715819;10.3164628770878;10.3152152288042;10.3139682260677;10.3127219658522;10.3114765428155;10.3102320493442;10.3089885755980;10.3077462095536;10.3065050370475;10.3052651418173;10.3040266055437;10.3027895078902;10.3015539265433;10.3003199372509;10.2990876138608;10.2978570283582;10.2966282509021;10.2954013498615;10.2941763918512;10.2929534417659;10.2917325628145;10.2905138165538;10.2892972629210;10.2880829602660;10.2868709653828;10.2856613335409;10.2844541185153;10.2832493726166;10.2820471467201;10.2808474902947;10.2796504514310;10.2784560768688;10.2772644120247;10.2760755010180;10.2748893866977;10.2737061106674;10.2725257133108;10.2713482338163;10.2701737102012;10.2690021793356;10.2678336769653;10.2666682377354;10.2655058952118;10.2643466819039;10.2631906292862;10.2620377678189;10.2608881269693;10.2597417352319;10.2585986201485;10.2574588083278;10.2563223254645;10.2551891963586;10.2540594449336;10.2529330942546;10.2518101665465;10.2506906832112;10.2495746648451;10.2484621312553;10.2473531014770;10.2462475937890;10.2451456257299;10.2440472141136;10.2429523750447;10.2418611239336;10.2407734755108;10.2396894438419;10.2386090423413;10.2375322837866;10.2364591803315;10.2353897435199;10.2343239842986;10.2332619130305;10.2322035395067;10.2311488729594;10.2300979220738;10.2290506949999;10.2280071993645;10.2269674422823;10.2259314303676;10.2248991697447;10.2238706660592;10.2228459244886;10.2218249497522;10.2208077461219;10.2197943174320;10.2187846670887;10.2177787980801;10.2167767129857;10.2157784139850;10.2147839028676;10.2137931810411;10.2128062495404;10.2118231090361;10.2108437598430;10.2098682019281;10.2088964349189;10.2079284581112;10.2069642704767;10.2060038706710;10.2050472570408;10.2040944276312;10.2031453801928;10.2022001121891;10.2012586208030;10.2003209029438;10.1993869552535;10.1984567741139;10.1975303556522;10.1966076957480;10.1956887900389;10.1947736339265;10.1938622225828;10.1929545509554;10.1920506137735;10.1911504055531;10.1902539206029;10.1893611530292;10.1884720967415;10.1875867454571;10.1867050927067;10.1858271318390;10.1849528560255;10.1840822582652;10.1832153313896;10.1823520680667;10.1814924608057;10.1806365019615;10.1797841837387;10.1789354981961;10.1780904372502;10.1772489926801;10.1764111561306;10.1755769191166;10.1747462730267;10.1739192091269;10.1730957185640;10.1722757923697;10.1714594214636;10.1706465966568;10.1698373086553;10.1690315480630;10.1682293053853;10.1674305710319;10.1666353353203;10.1658435884781;10.1650553206466;10.1642705218837;10.1634891821662;10.1627112913931;10.1619368393878;10.1611658159014;10.1603982106149;10.1596340131416;10.1588732130302;10.1581157997664;10.1573617627762;10.1566110914276;10.1558637750329;10.1551198028516;10.1543791640918;10.1536418479128;10.1529078434271;10.1521771397025;10.1514497257640;10.1507255905960;10.1500047231440;10.1492871123167;10.1485727469875;10.1478616159969;10.1471537081537;10.1464490122369;10.1457475169977;10.1450492111607;10.1443540834259;10.1436621224701;10.1429733169484;10.1422876554959;10.1416051267290;10.1409257192471;10.1402494216338;10.1395762224582;10.1389061102768;10.1382390736339;10.1375751010640;10.1369141810922;10.1362563022357;10.1356014530053;10.1349496219063;10.1343007974395;10.1336549681028;10.1330121223920;10.1323722488017;10.1317353358270;10.1311013719637;10.1304703457100;10.1298422455671;10.1292170600402;10.1285947776396;10.1279753868817;10.1273588762893;10.1267452343931;10.1261344497325;10.1255265108560;10.1249214063224;10.1243191247014;10.1237196545746;10.1231229845360;10.1225291031927;10.1219379991660;10.1213496610917;10.1207640776208;10.1201812374205;10.1196011291746;10.1190237415840;10.1184490633676;10.1178770832629;10.1173077900262;10.1167411724335;10.1161772192812;10.1156159193860;10.1150572615863;10.1145012347419;10.1139478277350;10.1133970294705;10.1128488288764;10.1123032149045;10.1117601765307;10.1112197027552;10.1106817826034;10.1101464051258;10.1096135593990;10.1090832345254;10.1085554196340;10.1080301038807;10.1075072764485;10.1069869265482;10.1064690434181;10.1059536163251;10.1054406345644;10.1049300874600;10.1044219643650;10.1039162546619;10.1034129477630;10.1029120331102;10.1024135001758;10.1019173384625;10.1014235375036;10.1009320868633;10.1004429761368;10.0999561949508;10.0994717329634;10.0989895798643;10.0985097253754;10.0980321592504;10.0975568712754;10.0970838512690;10.0966130890822;10.0961445745988;10.0956782977357;10.0952142484426;10.0947524167025;10.0942927925315;10.0938353659795;10.0933801271296;10.0929270660987;10.0924761730375;10.0920274381304;10.0915808515960;10.0911364036868;10.0906940846894;10.0902538849247;10.0898157947479;10.0893798045484;10.0889459047503;10.0885140858120;10.0880843382265;10.0876566525213;10.0872310192586;10.0868074290355;10.0863858724834;10.0859663402689;10.0855488230931;10.0851333116920;10.0847197968365;10.0843082693323;10.0838987200201;10.0834911397752;10.0830855195082;10.0826818501643;10.0822801227239;10.0818803282019;10.0814824576486;10.0810865021488;10.0806924528224;10.0803003008242;10.0799100373437;10.0795216536054;10.0791351408687;10.0787504904275;10.0783676936108;10.0779867417821;10.0776076263399;10.0772303387171;10.0768548703814;10.0764812128352;10.0761093576152;10.0757392962929;10.0753710204742;10.0750045217994;10.0746397919432;10.0742768226146;10.0739156055571;10.0735561325481;10.0731983953995;10.0728423859571;10.0724880961009;10.0721355177448;10.0717846428368;10.0714354633584;10.0710879713254;10.0707421587870;10.0703980178261;10.0700555405594;10.0697147191370;10.0693755457424;10.0690380125924;10.0687021119375;10.0683678360610;10.0680351772796;10.0677041279429;10.0673746804336;10.0670468271674;10.0667205605926;10.0663958731903;10.0660727574745;10.0657512059915;10.0654312113202;10.0651127660718;10.0647958628899;10.0644804944503;10.0641666534611;10.0638543326621;10.0635435248252;10.0632342227544;10.0629264192850;10.0626201072844;10.0623152796512;10.0620119293159;10.0617100492401;10.0614096324166;10.0611106718697;10.0608131606545;10.0605170918574;10.0602224585954;10.0599292540165;10.0596374712993;10.0593471036530;10.0590581443174;10.0587705865626;10.0584844236890;10.0581996490272;10.0579162559381;10.0576342378122;10.0573535880701;10.0570743001624;10.0567963675690;10.0565197837996;10.0562445423934;10.0559706369188;10.0556980609736;10.0554268081849;10.0551568722085;10.0548882467295;10.0546209254616;10.0543549021475;10.0540901705583;10.0538267244937;10.0535645577820;10.0533036642797;10.0530440378713;10.0527856724699;10.0525285620162;10.0522727004789;10.0520180818547;10.0517647001676;10.0515125494696;10.0512616238400;10.0510119173853;10.0507634242396;10.0505161385639;10.0502700545464;10.0500251664021;10.0497814683731;10.0495389547280;10.0492976197621;10.0490574577972;10.0488184631817;10.0485806302900;10.0483439535230;10.0481084273075;10.0478740460965;10.0476408043688;10.0474086966288;10.0471777174069;10.0469478612588;10.0467191227660;10.0464914965350;10.0462649771978;10.0460395594115;10.0458152378584;10.0455920072454;10.0453698623046;10.0451487977926;10.0449288084909;10.0447098892053;10.0444920347661;10.0442752400280;10.0440594998700;10.0438448091950;10.0436311629300;10.0434185560262;10.0432069834582;10.0429964402245;10.0427869213474;10.0425784218724;10.0423709368687;10.0421644614287;10.0419589906679;10.0417545197251;10.0415510437620;10.0413485579634;10.0411470575366;10.0409465377119;10.0407469937421;10.0405484209026;10.0403508144910;10.0401541698276;10.0399584822546;10.0397637471365;10.0395699598597;10.0393771158328;10.0391852104858;10.0389942392709;10.0388041976617;10.0386150811534;10.0384268852626;10.0382396055273;10.0380532375069;10.0378677767818;10.0376832189534;10.0374995596444;10.0373167944981;10.0371349191786;10.0369539293710;10.0367738207806;10.0365945891336;10.0364162301763;10.0362387396755;10.0360621134182;10.0358863472117;10.0357114368830;10.0355373782795;10.0353641672681;10.0351917997357;10.0350202715889;10.0348495787538;10.0346797171761;10.0345106828209;10.0343424716726;10.0341750797350;10.0340085030309;10.0338427376022;10.0336777795099;10.0335136248337;10.0333502696725;10.0331877101435;10.0330259423827;10.0328649625448;10.0327047668027;10.0325453513481;10.0323867123905;10.0322288461579;10.0320717488966;10.0319154168706;10.0317598463620;10.0316050336709;10.0314509751150;10.0312976670300;10.0311451057689;10.0309932877025;10.0308422092190;10.0306918667241;10.0305422566405;10.0303933754085;10.0302452194852;10.0300977853452;10.0299510694798;10.0298050683971;10.0296597786224;10.0295151966975;10.0293713191809;10.0292281426478;10.0290856636898;10.0289438789150;10.0288027849479;10.0286623784292;10.0285226560161;10.0283836143814;10.0282452502145;10.0281075602205;10.0279705411205;10.0278341896514;10.0276985025659;10.0275634766323;10.0274291086346;10.0272953953724;10.0271623336607;10.0270299203298;10.0268981522255;10.0267670262087;10.0266365391556;10.0265066879574;10.0263774695204;10.0262488807659;10.0261209186299;10.0259935800635;10.0258668620324;10.0257407615170;10.0256152755123;10.0254904010279;10.0253661350877;10.0252424747303;10.0251194170085;10.0249969589892;10.0248750977537;10.0247538303975;10.0246331540300;10.0245130657746;10.0243935627687;10.0242746421637;10.0241563011245;10.0240385368300;10.0239213464727;10.0238047272585;10.0236886764073;10.0235731911519;10.0234582687390;10.0233439064285;10.0232301014933;10.0231168512201;10.0230041529081;10.0228920038701;10.0227804014318;10.0226693429317;10.0225588257213;10.0224488471652;10.0223394046403;10.0222304955366;10.0221221172568;10.0220142672158;10.0219069428415;10.0218001415739;10.0216938608658;10.0215880981820;10.0214828509999;10.0213781168090;10.0212738931109;10.0211701774195;10.0210669672608;10.0209642601725;10.0208620537047;10.0207603454190;10.0206591328890;10.0205584137002;10.0204581854497;10.0203584457462;10.0202591922102;10.0201604224736;10.0200621341798;10.0199643249838;10.0198669925519;10.0197701345618;10.0196737487022;10.0195778326735;10.0194823841868;10.0193874009647;10.0192928807407;10.0191988212593;10.0191052202760;10.0190120755571;10.0189193848801;10.0188271460328;10.0187353568141;10.0186440150335;10.0185531185112;10.0184626650779;10.0183726525750;10.0182830788541;10.0181939417776;10.0181052392181;10.0180169690586;10.0179291291923;10.0178417175228;10.0177547319637;10.0176681704389;10.0175820308824;10.0174963112381;10.0174110094601;10.0173261235123;10.0172416513685;10.0171575910125;10.0170739404378;10.0169906976476;10.0169078606550;10.0168254274825;10.0167433961625;10.0166617647368;10.0165805312568;10.0164996937834;10.0164192503867;10.0163391991465;10.0162595381519;10.0161802655010;10.0161013793016;10.0160228776703;10.0159447587332;10.0158670206252;10.0157896614905;10.0157126794824;10.0156360727628;10.0155598395031;10.0154839778830;10.0154084860916;10.0153333623264;10.0152586047940;10.0151842117095;10.0151101812968;10.0150365117883;10.0149632014253;10.0148902484573;10.0148176511426;10.0147454077478;10.0146735165481;10.0146019758270;10.0145307838763;10.0144599389962;10.0143894394951;10.0143192836899;10.0142494699053;10.0141799964744;10.0141108617384;10.0140420640465;10.0139736017560;10.0139054732321;10.0138376768481;10.0137702109851;10.0137030740323;10.0136362643863;10.0135697804521;10.0135036206419;10.0134377833761;10.0133722670824;10.0133070701964];

%erro de ajuste
erro_quad = (y_dir - y_sys)'*(y_dir - y_sys);

%penalidade

satura = u_l.*(u_l > 4095);
penalidade = sum(satura);

erro = erro_quad + penalidade;
end

